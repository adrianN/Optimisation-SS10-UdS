\section{Totally unimodular matrices}

TDIness is a little weird and hard to check. A much easier recognizable property that also implies integrality of the polyhedron is total unimodularity.

\begin{Def} A $m\times n$ matrix $A$ is totally unimodular (TU) if each subdeterminant (the determinant of a square submatrix), i.e. each \href{http://en.wikipedia.org/wiki/Minor\_\%28linear\_algebra\%29}{minor}, of $A$ is $\in \{-1,0,1\}$
\end{Def}

That means in particular that also all entries are $\in \{-1,0,1\}$.

\begin{thm}[Hoffman, Kruskal '56] $A\in \Z^{m\times n}$ is TU iff $P=\{x|Ax\leq b\}$ is integral for any integral $b$
\end{thm}

So if we have a TDI system the matrix is totally unimodular. A quite suprising connection between duality and the determinant, if you ask me.

\begin{pr} $\Rightarrow$ Let $A$ be TU, $b\in \Z^m$ and let $x$ be a vertex of the induced polyhedron $P$. We want to show that $x$ is integral.

Since $x$ is a basic solution there is a nonsingular $n\times n$ submatrix of $A$, let's call it $A_x$ that is the basis for $x$. We can then calculate the value of $x$ as $A_x^{-1}b'$, where $b'$ is $b$ restricted to the rows in $A_x$. 

Because $A$ is totally unimodular and $A_x$ is nonsingular we know $|\det A_x|=1$. But that implies that $A_x^{-1}$ only has integral entries (to see why have a look at Cramer's rule for computing the inverse). Since $b'$ is also integral it follows that $x$ must be integral too.

$\Leftarrow$ Suppose all vertices of $P$ are integral vectors $\forall b\in \Z^m$. We want to show that every nonsingular square submatrix $A'$ has a determinant of $\{1,-1\}$. By switching rows and columns around we can assume that the submatrix $A'$ lies in the topleft corner of $A$ (switching things only changes the sign of the determinant). 

We expand $A$ by the identity matrix, $(A|I)$. Then we can construct a new matrix $B\in \Z^{m\times m}$ such that $\det (A') = \det (B)$ by taking a the first few and the last few columns of $(A|I)$ to build:

\[B = \left({A' \atop *} {0\atop I}\right)\]

To prove $|\det (B)| =1$ it suffices we show $B^{-1}$ is integral because

\[\det(BB^{-1}) = \det(I) = \det(B)\cdot\det(B^{-1}) = 1\]

and our knowledge that $\det (B)$ is integral (since $B$ is integral). If $B^{-1}$ is also integral we multiply two integrals. We can only get $1$ if both are either $1$ or $-1$.

To prove $B^{-1}$ is integral we choose $i\in \{1,\ldots, m\}$ and show that $B^{-1}e_i\in \Z^m$. Take some $y\in \Z^m$ s.t. $z:= y + B^{-1}e_1\geq 0$. 

By multiplying both sides with $B$ we get $b:= Bz=By+e_i$. $b$ is integral because $B$,$y$ and $e_i$ are integral. We can add $n$ zeros to the middle of $z$ (in the positions of the columns we didn't choose to form $B$) such that the new $z'$ fulfills $(A|I)z'=b$. The first $n$ entries of $z'$, call them $z''$ is in $P$ since

\[Az''\leq b\]

In particular the $k$ constraints from $A'$ are fulfilled with equality because we know $(A|I)z'=b$. It also fulfils $m-k$ non-negativity constraints, so it's a vertex:

\[\begin{pmatrix}
A' & *\\
* & *\\
-I_k & 0 \\
0 & I_{m-k}
\end{pmatrix} \cdot z'' \leq \left(b \atop 0\right)\]

That means $z''$ is integral, because the polyhedron is integral. That implies that $z'$ is also integral, since $b$ is integral and the lower components are produced by the identity matrix. Then of course $z$ is also integral.

Then we have from the definitions above

\[z-y=B^{-1}e_i\]

But since $z$ and $y$ are integral $B^{-1}e_i$ must also be integral.

\end{pr}

\begin{thm} Let $A\in \Z^{m\times m}$. The following statements are equivalent
\begin{enumerate}
\item $A$ is TU
\item $\forall b \in \Z^m, c\in \Z^m$:
\[\max \{cx|Ax\leq b, x\geq 0\} = \min \{\trans y b|\trans A \geq c, y\geq 0\}\]
and they have integral optimal solutions or are unbounded
\item $Ax\leq b, x\geq 0$ is TDI for all $b\in \Z^m$
\item $\forall\ \text{rows}\ R\subset \{1,\ldots, m\} \exists\ \text{partition}\ R = R_1 \dot \cup R_2$ such that

\[\sum_{i\in R_1} a_{ij} - \sum_{i\in R_2} a_{ij} \in \{-1,0,1\}, \qquad \forall j\in \{1,\ldots, n\}\]
\end{enumerate}
\end{thm}

The last part tells us something about edge incidence matrices of graphs and total unimodularity: for all undirected graphs is totally unimodular iff the graph is bipartite. We can then partition the matrix like requested by using the two partitions of the graph. Then the difference must always be zero.